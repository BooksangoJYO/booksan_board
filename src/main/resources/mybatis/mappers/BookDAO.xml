<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC  "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="io.booksan.booksan_board.dao.BookDAO">
	<!-- 카테고리 목록 가져오기(게시물 등록시 카테고리 필요) -->
	<select id="getCategories">
		select * from BOOKS_CATEGORIES order by books_category_id
	</select>

	<!-- 책정보 등록(게시물 등록시) -->
	<insert id="insertBookInfo" parameterType="io.booksan.booksan_board.vo.BookInfoVO">
		insert into BOOKS_INFO(isbn, book_title, book_writer, book_publisher)
		values(#{isbn}, #{bookTitle}, #{bookWriter}, #{bookPublisher})
	</insert>
	
	<!-- isbn 존재여부 확인(존재하는 isbn인 경우 책등록 x) -->
	<select id="isISBNExists">
		select count(*) from BOOKS_INFO where isbn=#{isbn}
	</select>
	
	<!-- 책 평가 댓글 목록 가져오기 -->
	<select id="getComment">
		select * from BOOK_COMMENT where isbn=#{isbn} order by insert_datetime		
	</select>
	
	<!-- 책 평가 댓글 등록 -->
	<insert id="insertComment">
		insert into BOOK_COMMENT(isbn, uid, content)
		values(#{isbn}, #{uid}, #{content})
	</insert>
	
	<!-- 책 평가 댓글 수정 -->
	<update id="updateComment">
		update BOOK_COMMENT
		set content=#{content},
			updated_datetime = now()
		where comment_id = #{commentId}
	</update>
	
	<!-- 책 평가 댓글 삭제(disabled='Y') -->
	<update id="deleteComment">
		update BOOK_COMMENT
		set disabled = 'Y'
		where comment_id = #{commentId}
	</update>
	
	

</mapper>